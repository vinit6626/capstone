<%- include("partials/header.ejs") -%>
<div class="container login mb-5">
    <% if (msg) { %>
        <div class="alert alert-warning alert-dismissible fade show mt-4" role="alert">
          <strong><%= msg %></strong>
          <button type="button" class="close" data-dismiss="alert" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
      <% } %>
<div class="container">
  <div class="row justify-content-center mt-5">
    <div class="col-sm-6">
      <div class="card">
        <div class="card-body">
          <form name="myForm1" action="/updatepassword" method="post" class="container userForm" onsubmit="return validateForm()">
            <h3 class="card-title center mb-4 text-center "><b>Forgot Password</b></h3>

            <div class="form-group">
              <label for="exampleInputEmail2">Email</label>
              <input type="email" class="form-control padding04" id="exampleInputEmail2" aria-describedby="emailHelp" name="email" placeholder="Enter Email" value="<%= email %>">
              <span id="message" style="color:red"></span>
            </div>

            <div class="form-group">
              <label for="exampleInputPassword3">Enter Verification Code</label>
              <input type="text" class="form-control padding04" id="exampleInputPassword3" placeholder="Verification Code" name="verificationCode">
              <span id="code" style="color:red"></span>
            </div>
            <div class="form-group">
              <label for="exampleInputPassword3">New Password</label>
              <input type="password" class="form-control padding04" id="exampleInputPassword3" placeholder="New Password" name="password">
              <span id="message1" style="color:red"></span>
            </div>
            <div class="form-group">
                <label for="exampleInputPassword2">Confirm Password</label>
                <input type="password" class="form-control" id="exampleInputPassword2"
                       placeholder="Confirm password" name="c_password">
                <span id="message2" style="color:red"></span>
            </div>
            <a href="login">Login</a>
            <p class="text-center">
              <button type="submit" class="btn btn-primary">Update Password</button>
            </p>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>
</div>

<%- include("partials/footer.ejs") -%>
<script>
    function validateForm() {
      var email = document.forms["myForm1"]["email"].value;
      var password = document.forms["myForm1"]["password"].value;
      var c_password = document.forms["myForm1"]["c_password"].value;
      var c_password = document.forms["myForm1"]["c_password"].value;
      var verificationCode = document.forms["myForm1"]["verificationCode"].value;
  
      var emailPattern = /^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/;
  
      document.getElementById("message").innerHTML = "";
      document.getElementById("message1").innerHTML = "";
      document.getElementById("message2").innerHTML = "";
      document.getElementById("code").innerHTML = "";
  
      if (!email.match(emailPattern)) {
        document.getElementById("message").innerHTML = "Please enter a valid email address.";
        return false;
      }
      if (password.length < 5) {
        document.getElementById("code").innerHTML = "Please enter a valid code.";
        return false;
      }
      if (password.length < 8) {
        document.getElementById("message1").innerHTML = "Password must be at least 8 characters long.";
        return false;
      }
  
      if (password !== c_password) {
        document.getElementById("message2").innerHTML = "Passwords do not match.";
        return false;
      }
  
      return true; 
    }
  </script>
  